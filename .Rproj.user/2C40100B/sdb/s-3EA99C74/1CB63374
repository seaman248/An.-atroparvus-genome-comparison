{
    "collab_server" : "",
    "contents" : "library('genoPlotR')\nsource('./R/functions/create_seg.R')\nsource('./R/functions/create_xlims.R')\nsource('./R/functions/make_chr_annots.R')\nsource('./R/functions/block_annots.R')\nsource('./R/functions/make_comparison.R')\nblocks <- read.table('./data/processed/blocks.txt')\nnames(blocks) <- c('id', \n                   'chr', 'start', 'end', 'strand',\n                   'chr', 'start', 'end', 'strand',\n                   'chr', 'start', 'end', 'strand'\n                   )\n\n\nblocks[,1]<- as.character(blocks[,1])\n# length to end coordinates\nblocks[,c(4, 8, 12)] <- blocks[,c(3, 7, 11)]+blocks[,c(4, 8, 12)]\n\nalb_blocks <- blocks[,c(1, 2, 3, 4, 5)]\natr_blocks <- blocks[,c(1, 6, 7, 8, 9)]\ngam_blocks <- blocks[,c(1, 10, 11, 12, 13)]\n\nablocks <- list(alb_blocks, atr_blocks, gam_blocks)\nnames(ablocks) <- c('alb', 'atr', 'gam')\nrm(blocks, alb_blocks, atr_blocks, gam_blocks)\n\n# make atroparvus main\nablocks <- lapply(ablocks, function(blocks){\n  blocks[,5] <- blocks[,5]*ablocks[[2]][5]\n  return(blocks)\n})\n\n# create segs\ndna_segs <- lapply(ablocks, create_seqs)\n\n# create xlims\n\nchr_order <- list(\n  alb=c('X','2R', '3L', '2L', '3R'),\n  atr=c('X', '3R', '2L', '2R', '3L'),\n  gam=c('X','2R', '2L', '3R', '3L')\n)\n\ncent_right <- list(\n  alb=c(F, T, F, F, T),\n  atr=c(T, T, T, T, T),\n  gam=c(F, T, F, T, F)\n)\n\n\nxlims <- as.list(\n  data.frame(\n    mapply(create_xlims, genes=ablocks, strand=cent_right, chrs=chr_order)\n  )\n)\n\n# create comparisons\ncomparisons <- make_comparisons(dna_segs)\n\n#create annotations\n\nalb_order <- c('X','2L(e4)', '2R(e2)', '3L(e3)','3R(e5)')\natr_order <- c('X','2L(e3)', '2R(e4)', '3L(e5)', '3R(e2)')\ngam_order <- c('X','c2L(e3)', '2R(e2)', '3L(e5)', '3R(e4)')\n\nalb_annot <- make_chr_annot(xlims[[1]], alb_order)\natr_annot <- make_chr_annot(xlims[[2]], atr_order)\ngam_annot <- make_chr_annot(xlims[[3]], gam_order)\n# alb_annot <- blockAnnots(alb_seg)\n# atr_annot <- blockAnnots(atr_seg)\n# gam_annot <- blockAnnots(gam_seg)\n\nannots <- list(alb_annot, atr_annot, gam_annot)\nrm(alb_order, atr_order, gam_order, alb_annot, atr_annot, gam_annot)\n# create phyl tree\ntree <- newick2phylog(\"((An_atroparvus,An_gambiae), An_albimanus);\")\n\ntiff('./output/plot_c_p_m5_g100(main atr).tiff', width=15000, height=2500, units='px', compression = 'none', res=600)\nplot_gene_map(\n  dna_segs = dna_segs,\n  xlims = xlims,\n  comparisons = comparisons,\n  dna_seg_labels = NULL,\n  dna_seg_label_cex = 0\n)\ndev.off()",
    "created" : 1485500293938.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1190471510",
    "id" : "1CB63374",
    "lastKnownWriteTime" : 1485580106,
    "last_content_update" : 1485580106378,
    "path" : "~/rproj/full_gene/R/visualize.R",
    "project_path" : "R/visualize.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}