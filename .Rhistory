blocks_command <- paste0(
grimm_path, ' -f ',
output_anchors, '/unique_coords.txt', ' -d ',
output_blocks,
' -c -m ', min_block, ' -g ', min_gap, ' -Q'
)
system(blocks_command, wait=TRUE)
source('./R/visualize.R')
source('./R/visualize.R')
blocks_command
source('./R/visualize.R')
source('./R/visualize.R')
source('./R/visualize.R')
50000000/100000
source('./R/visualize.R')
source('./R/visualize.R')
source('./R/visualize.R')
source('./R/visualize.R')
source('./R/visualize.R')
source('./R/visualize.R')
source('./R/visualize.R')
source('./R/visualize.R')
source('./R/visualize.R')
source('./R/visualize.R')
source('./R/visualize.R')
50000000/100000
50000000/100000
source('./R/visualize.R')
source('./R/visualize.R')
source('./R/visualize.R')
source('./R/visualize.R')
source('./R/visualize.R')
source('./R/visualize.R')
source('./R/visualize.R')
View(tableForGRIMM)
lapply(tableForGRIMM[,c(4,8,12], mean)
apply(tableForGRIMM[,c(4,8,12], 1,  mean)
lapply(tableForGRIMM[,c(4,8,12), mean)
lapply(tableForGRIMM[,c(4,8,12)], mean)
source('./R/visualize.R')
lapply(tableForGRIMM[,c(4,8,12), mean*2)
lapply(tableForGRIMM[,c(4,8,12), mean)
lapply(tableForGRIMM[,c(4,8,12)], mean*2)
lapply(tableForGRIMM[,c(4,8,12)], mean)
4567*2
6223*2
8221*2
source('./R/visualize.R')
source('./R/visualize.R')
source('./R/visualize.R')
source('./R/visualize.R')
source('./R/visualize.R')
source('./R/visualize.R')
lapply(tableForGRIMM[,c(4,8,12)], mean)
4525+6222+8220
18967/
3
testGRIMM_g <- function(m='6000', g){
grimm_path <- '~/Documents/GRIMM_SYNTENY-2.02/grimm_synt'
input_path <- '~/rproj/full_gene/data/processed/tableForGRIMM.txt'
output_anchors <- '~/rproj/full_gene/data/processed/test_anchors'
output_blocks <- '~/rproj/full_gene/data/processed/test_blocks'
anchor_command <- paste(grimm_path, '-A -f', input_path, '-d', output_anchors)
system(anchor_command, wait = TRUE)
min_block = m
for(i in length(g)){
gap=g[i]
blocks_command <- paste0(
grimm_path, ' -f ',
output_anchors, '/unique_coords.txt', ' -d ',
output_blocks,
' -c -m', min_block, ' -g ', gap, ' -Q'
)
system(blocks_command, wait=TRUE)
}
}
seq(1000, 1000000, 10000)
testGRIMM_g(seq(1000, 1000000, 10000))
testGRIMM_g(g=seq(1000, 1000000, 10000))
testGRIMM_g <- function(m='6000', g){
grimm_path <- '~/Documents/GRIMM_SYNTENY-2.02/grimm_synt'
input_path <- '~/rproj/full_gene/data/processed/tableForGRIMM.txt'
output_anchors <- '~/rproj/full_gene/data/processed/test_anchors'
output_blocks <- '~/rproj/full_gene/data/processed/test_blocks'
anchor_command <- paste(grimm_path, '-A -f', input_path, '-d', output_anchors)
system(anchor_command, wait = TRUE)
min_block = m
for(i in length(g)){
gap=g[i]
blocks_command <- paste0(
grimm_path, ' -f ',
output_anchors, '/unique_coords.txt', ' -d ',
output_blocks,
' -c -m', min_block, ' -g ', gap, ' -Q'
)
system(blocks_command, wait=TRUE)
print(nrow(write.table('./data/processed/test_blocks/blocks.txt')))
}
}
testGRIMM_g(g=seq(1000, 1000000, 10000))
g=seq(1000, 1000000, 10000)
length(g)
testGRIMM_g <- function(m='6000', g){
grimm_path <- '~/Documents/GRIMM_SYNTENY-2.02/grimm_synt'
input_path <- '~/rproj/full_gene/data/processed/tableForGRIMM.txt'
output_anchors <- '~/rproj/full_gene/data/processed/test_anchors'
output_blocks <- '~/rproj/full_gene/data/processed/test_blocks'
anchor_command <- paste(grimm_path, '-A -f', input_path, '-d', output_anchors)
system(anchor_command, wait = TRUE)
min_block = m
for(i in 1:length(g)){
gap=g[i]
blocks_command <- paste0(
grimm_path, ' -f ',
output_anchors, '/unique_coords.txt', ' -d ',
output_blocks,
' -c -m', min_block, ' -g ', gap, ' -Q'
)
system(blocks_command, wait=TRUE)
print(nrow(write.table('./data/processed/test_blocks/blocks.txt')))
}
}
results <- data.frame(
n=1:length(g)
)
grimm_g <- testGRIMM_g(g=seq(1000, 1000000, 10000))
grimm_g
write.table('./data/processed/test_blocks/blocks.txt')
read.table('./data/processed/test_blocks/blocks.txt')
testGRIMM_g <- function(m='6000', g){
grimm_path <- '~/Documents/GRIMM_SYNTENY-2.02/grimm_synt'
input_path <- '~/rproj/full_gene/data/processed/tableForGRIMM.txt'
output_anchors <- '~/rproj/full_gene/data/processed/test_anchors'
output_blocks <- '~/rproj/full_gene/data/processed/test_blocks'
anchor_command <- paste(grimm_path, '-A -f', input_path, '-d', output_anchors)
system(anchor_command, wait = TRUE)
min_block = m
results <- list()
for(i in 1:length(g)){
gap=g[i]
blocks_command <- paste0(
grimm_path, ' -f ',
output_anchors, '/unique_coords.txt', ' -d ',
output_blocks,
' -c -m', min_block, ' -g ', gap, ' -Q'
)
system(blocks_command, wait=TRUE)
results[i] <- read.table('./data/processed/test_blocks/blocks.txt')
}
return(results)
}
grimm_g <- testGRIMM_g(g=seq(1000, 1000000, 10000))
grimm_g[[1]]
as.data.frame(grimm_g[[1]])
read.table('./data/processed/test_blocks/blocks.txt')
data.frame(read.table('./data/processed/test_blocks/blocks.txt'))
testGRIMM_g <- function(m='6000', g){
grimm_path <- '~/Documents/GRIMM_SYNTENY-2.02/grimm_synt'
input_path <- '~/rproj/full_gene/data/processed/tableForGRIMM.txt'
output_anchors <- '~/rproj/full_gene/data/processed/test_anchors'
output_blocks <- '~/rproj/full_gene/data/processed/test_blocks'
anchor_command <- paste(grimm_path, '-A -f', input_path, '-d', output_anchors)
system(anchor_command, wait = TRUE)
min_block = m
results <- list()
for(i in 1:length(g)){
gap=g[i]
blocks_command <- paste0(
grimm_path, ' -f ',
output_anchors, '/unique_coords.txt', ' -d ',
output_blocks,
' -c -m', min_block, ' -g ', gap, ' -Q'
)
system(blocks_command, wait=TRUE)
results[i] <- data.frame(read.table('./data/processed/test_blocks/blocks.txt'))
}
return(results)
}
grimm_g <- testGRIMM_g(g=seq(1000, 1000000, 100000))
testGRIMM_g <- function(m='6000', g){
grimm_path <- '~/Documents/GRIMM_SYNTENY-2.02/grimm_synt'
input_path <- '~/rproj/full_gene/data/processed/tableForGRIMM.txt'
output_anchors <- '~/rproj/full_gene/data/processed/test_anchors'
output_blocks <- '~/rproj/full_gene/data/processed/test_blocks'
anchor_command <- paste(grimm_path, '-A -f', input_path, '-d', output_anchors)
system(anchor_command, wait = TRUE)
min_block = m
results <- list()
for(i in 1:length(g)){
gap=g[i]
blocks_command <- paste0(
grimm_path, ' -f ',
output_anchors, '/unique_coords.txt', ' -d ',
output_blocks,
' -c -m', min_block, ' -g ', gap, ' -Q'
)
system(blocks_command, wait=TRUE)
results[[i]] <- data.frame(read.table('./data/processed/test_blocks/blocks.txt'))
}
return(results)
}
grimm_g <- testGRIMM_g(g=seq(1000, 1000000, 100000))
gap_range <- seq(1000, 1000000, 100000)
lapply(grimm_g, nrow)
col_blocks <- unlist(lapply(grimm_g, nrow))
gap_range <- seq(1000, 50000000, 100000)
length(gap_range)
gap_range <- seq(1000, 50000000, 500000)
length(gap_range)
grimm_g <- testGRIMM_g(g=gap_range)
testGRIMM_g <- function(m='6000', g){
grimm_path <- '~/Documents/GRIMM_SYNTENY-2.02/grimm_synt'
input_path <- '~/rproj/full_gene/data/processed/tableForGRIMM.txt'
output_anchors <- '~/rproj/full_gene/data/processed/test_anchors'
output_blocks <- '~/rproj/full_gene/data/processed/test_blocks'
anchor_command <- paste(grimm_path, '-A -f', input_path, '-d', output_anchors)
system(anchor_command, wait = TRUE)
min_block = m
results <- list()
pb <- txtProgressBar(min = 1, max = length(g), style = 3)
for(i in 1:length(g)){
Sys.sleep(0.1)
gap=g[i]
blocks_command <- paste0(
grimm_path, ' -f ',
output_anchors, '/unique_coords.txt', ' -d ',
output_blocks,
' -c -m', min_block, ' -g ', gap, ' -Q'
)
system(blocks_command, wait=TRUE)
results[[i]] <- data.frame(read.table('./data/processed/test_blocks/blocks.txt'))
setTxtProgressBar(pb, i)
}
return(results)
}
testGRIMM_g(g=seq(1000, 10000, 1000))
col_blocks <- unlist(lapply(grimm_g, nrow))
col_blocks
scatterplot
scatterplot()
install.packages("ggplot2")
library(ggplot2)
ggplot(aes(x=gap_range, y=grimm_g))
plot(x=gap_range, y=col_blocks)
gap_range <- seq(10, 500000, 10000)
length(gap_range)
gap_range <- seq(10, 500000, 10000)
grimm_g <- testGRIMM_g(g=gap_range)
col_blocks <- unlist(lapply(grimm_g, nrow))
plot(x=gap_range, y=col_blocks)
gap_range <- seq(10, 100000, 5000)
length(gap_range)
grimm_g <- testGRIMM_g(g=gap_range)
col_blocks <- unlist(lapply(grimm_g, nrow))
plot(x=gap_range, y=col_blocks)
grimm_g[[1]]
lapply(grimm_g, '[', c(4, 8, 12))
lapply(lapply(grimm_g, '[', c(4, 8, 12)), function(lengths){
return(data.frame(
alb=mean(lengths[1]),
atr=mean(lengths[2]),
gam=mean(lengths[3])
))
})
lapply(grimm_g, '[', c(4, 8, 12))
lapply(lapply(grimm_g, '[', c(4, 8, 12)), function(lengths){
return(data.frame(
alb=mean(lengths[1]),
atr=mean(lengths[2]),
gam=mean(lengths[3])
))
})
warnings()
lapply(lapply(grimm_g, '[', c(4, 8, 12)), function(lengths){
return(data.frame(
alb=mean(lengths[1]),
atr=mean(lengths[2]),
gam=mean(lengths[3])
))
})
lapply(grimm_g, '[', c(4, 8, 12))
lapply(lapply(grimm_g, '[', c(4, 8, 12)), function(lengths){
return(data.frame(
alb=mean(lengths[[1]]),
atr=mean(lengths[[2]]),
gam=mean(lengths[[3]])
))
})
mean_block_length <- lapply(lapply(grimm_g, '[', c(4, 8, 12)), function(lengths){
return(data.frame(
alb=mean(lengths[[1]]),
atr=mean(lengths[[2]]),
gam=mean(lengths[[3]])
))
})
unlist(mean_block_length)
as.data.frame(mean_block_length)
data.frame(mean_block_length)
data.frame(matrix(mean_block_length))
length(gap_range)
mean_block_length <- data.frame(matrix(mean_block_length))
xyplot()
plot(gap_range, mean_block_length$matrix.mean_block_length)
mean_block_length
View(mean_block_length)
mean_block_length <- data.frame(matrix(unlist(mean_block_length)))
mean_block_length <- lapply(lapply(grimm_g, '[', c(4, 8, 12)), function(lengths){
return(data.frame(
alb=mean(lengths[[1]]),
atr=mean(lengths[[2]]),
gam=mean(lengths[[3]])
))
})
mean_block_length <- data.frame(matrix(unlist(mean_block_length)))
View(mean_block_length)
rep(1:4, each=2)
rep(c('alb', 'atr', 'gam'), each=20)
mean_block_length$sp <- rep(c('alb', 'atr', 'gam'), each=20)
View(mean_block_length)
mean_block_length <- lapply(lapply(grimm_g, '[', c(4, 8, 12)), function(lengths){
return(table(
alb=mean(lengths[[1]]),
atr=mean(lengths[[2]]),
gam=mean(lengths[[3]])
))
})
mean_block_length[[1]]
mean_block_length <- lapply(lapply(grimm_g, '[', c(4, 8, 12)), function(lengths){
return(c(
mean(lengths[[1]]),
mean(lengths[[2]]),
mean(lengths[[3]])
))
})
data.frame(mean_block_length)
rbind(mean_block_length)
lapply(mean_block_length, rbind)
do.call(rbind.data.frame, mean_block_length)
mean_block_length <- do.call(rbind.data.frame, mean_block_length)
View(mean_block_length)
names(mean_block_length) <- c('alb', 'atr', 'gam')
plot(gap_range, mean_block_length$alb)
plot(gap_range, mean_block_length$atr)
plot(gap_range, mean_block_length$gam)
plot(gap_range, mean_block_length$gam, type = 'l')
source('~/rproj/full_gene/R/testGRIMM.R')
plot(gap_range, mean_block_length$alb, type = 'l')
lines(mean_block_length$atr)
plot(gap_range, mean_block_length$alb, type = 'l')
lines(gap_range, mean_block_length$atr)
lines(gap_range, mean_blocks_length$gam)
plot(gap_range, mean_block_length$alb, type = 'l')
lines(gap_range, mean_block_length$atr)
lines(gap_range, mean_blocks_length$gam)
plot(gap_range, mean_block_length$alb, type = 'l')
lines(gap_range, mean_block_length$atr)
lines(gap_range, mean_block_length$gam)
plot(gap_range, mean_block_length$alb, type = 'l')
lines(gap_range, mean_block_length$atr, col='orange')
lines(gap_range, mean_block_length$gam, col='red')
plot(gap_range, mean_block_length$alb, type = 'l', col='green')
lines(gap_range, mean_block_length$atr, col='orange')
lines(gap_range, mean_block_length$gam, col='red')
plot(gap_range, mean_block_length$alb, type = 'l', col='green')
lines(gap_range, mean_block_length$atr, col='orange')
lines(gap_range, mean_block_length$gam, col='red')
legend()
plot(x=gap_range, y=col_blocks)
plot(x=gap_range, y=col_blocks, type='l')
plot(gap_range, mean_block_length$alb, type = 'l', col='green')
lines(gap_range, mean_block_length$atr, col='orange')
lines(gap_range, mean_block_length$gam, col='red')
legend(x=0, y=0, legend = c('alb', 'atr', 'gam'), col=c('green', 'orange', 'red'))
plot(gap_range, mean_block_length$alb, type = 'l', col='green')
lines(gap_range, mean_block_length$atr, col='orange')
lines(gap_range, mean_block_length$gam, col='red')
legend(x=0, legend = c('alb', 'atr', 'gam'), col=c('green', 'orange', 'red'))
legend(legend = c('alb', 'atr', 'gam'), col=c('green', 'orange', 'red'))
plot(gap_range, mean_block_length$alb, type = 'l', col='green')
lines(gap_range, mean_block_length$atr, col='orange')
lines(gap_range, mean_block_length$gam, col='red')
legend(-1, 1.9, c('alb'))
plot(gap_range, mean_block_length$alb, type = 'l', col='green')
lines(gap_range, mean_block_length$atr, col='orange')
lines(gap_range, mean_block_length$gam, col='red')
legend(60000, 70000, legend=c('alb', 'atr', 'gam'), col=c('green', 'orange', 'red'))
plot(gap_range, mean_block_length$alb, type = 'l', col='green')
lines(gap_range, mean_block_length$atr, col='orange')
lines(gap_range, mean_block_length$gam, col='red')
legend(60000, 70000, legend=c('alb', 'atr', 'gam'), col=c('green', 'orange', 'red'), lty=1:2)
plot(gap_range, mean_block_length$alb, type = 'l', col='green')
lines(gap_range, mean_block_length$atr, col='orange')
lines(gap_range, mean_block_length$gam, col='red')
legend(60000, 70000, legend=c('alb', 'atr', 'gam'), col=c('green', 'orange', 'red'), lty=1)
plot(gap_range, mean_block_length$alb, type = 'l', col='green')
lines(gap_range, mean_block_length$atr, col='orange')
lines(gap_range, mean_block_length$gam, col='red')
legend(60000, 70000, legend=c('alb', 'atr', 'gam'), col=c('green', 'orange', 'red'), lty=1, box.lty = 0)
plot(gap_range, mean_block_length$alb, type = 'l', col='green')
lines(gap_range, mean_block_length$atr, col='orange')
lines(gap_range, mean_block_length$gam, col='red')
legend(50000, 80000, legend=c('alb', 'atr', 'gam'), col=c('green', 'orange', 'red'), lty=1, box.lty = 0)
plot(gap_range, mean_block_length$alb, type = 'l', col='green', xlab = 'Gap size, bp', ylab = 'Mean block length')
lines(gap_range, mean_block_length$atr, col='orange')
lines(gap_range, mean_block_length$gam, col='red')
legend(50000, 80000, legend=c('alb', 'atr', 'gam'), col=c('green', 'orange', 'red'), lty=1, box.lty = 0)
col_blocks <- unlist(lapply(grimm_g, nrow))
plot(x=gap_range, y=col_blocks, type='l')
plot(gap_range, mean_block_length$alb, type = 'l', col='green', xlab = 'Gap size, bp', ylab = 'Mean block length, bp')
lines(gap_range, mean_block_length$atr, col='orange')
lines(gap_range, mean_block_length$gam, col='red')
legend(50000, 80000, legend=c('alb', 'atr', 'gam'), col=c('green', 'orange', 'red'), lty=1, box.lty = 0)
plot(x=gap_range, y=col_blocks, type='l', xlim='Gap size, bp')
plot(x=gap_range, y=col_blocks, type='l', xlim='Gap size, bp')
plot(x=gap_range, y=col_blocks, type='l')
plot(x=gap_range, y=col_blocks, type='l', xlim = 'Gap size, bp')
plot(x=gap_range, y=col_blocks, type='l', xlim = 'Gap size,bp')
plot(x=gap_range, y=col_blocks, type='l', xlab = 'Gap size bp')
plot(x=gap_range, y=col_blocks, type='l', xlab = 'Gap size bp', ylab='Number of blocks')
80/(0.12*365*3)
80/(0.0000006*365*3)
80/0.0000006
133333333/100
source('./R/visualize.R')
col_blocks <- unlist(lapply(grimm_g, nrow))
plot(x=gap_range, y=col_blocks, type='l', xlab = 'Gap size bp', ylab='Number of blocks')
## Mean length of blocks
mean_block_length <- lapply(lapply(grimm_g, '[', c(4, 8, 12)), function(lengths){
return(c(
mean(lengths[[1]]),
mean(lengths[[2]]),
mean(lengths[[3]])
))
})
mean_block_length <- do.call(rbind.data.frame, mean_block_length)
names(mean_block_length) <- c('alb', 'atr', 'gam')
sp_opt_gap <- lapply(c(1, 2, 3), function(n){
gap_range[which(mean_block_length[,n]>142000)[1]]
})
plot(gap_range, mean_block_length$alb, type = 'l', col='green', xlab = 'Gap size, bp', ylab = 'Mean block length, bp')
lines(gap_range, mean_block_length$atr, col='orange')
lines(gap_range, mean_block_length$gam, col='red')
lines(c(0, 250000), c(142000, 142000), col='black', pch=22, lty=2)
lapply(sp_opt_gap, function(gap){
lines(c(gap, gap), c(0, 142000), pch=22, lty=2)
})
legend(140000, 80000, legend=c('alb', 'atr', 'gam'), col=c('green', 'orange', 'red'), lty=1, box.lty = 0, cex=0.8)
gap_range <- seq(10, 250000, 5000)
grimm_g <- testGRIMM_g(g=gap_range)
## Number of blocks
col_blocks <- unlist(lapply(grimm_g, nrow))
plot(x=gap_range, y=col_blocks, type='l', xlab = 'Gap size bp', ylab='Number of blocks')
## Mean length of blocks
mean_block_length <- lapply(lapply(grimm_g, '[', c(4, 8, 12)), function(lengths){
return(c(
mean(lengths[[1]]),
mean(lengths[[2]]),
mean(lengths[[3]])
))
})
mean_block_length <- do.call(rbind.data.frame, mean_block_length)
names(mean_block_length) <- c('alb', 'atr', 'gam')
sp_opt_gap <- lapply(c(1, 2, 3), function(n){
gap_range[which(mean_block_length[,n]>142000)[1]]
})
plot(gap_range, mean_block_length$alb, type = 'l', col='green', xlab = 'Gap size, bp', ylab = 'Mean block length, bp')
lines(gap_range, mean_block_length$atr, col='orange')
lines(gap_range, mean_block_length$gam, col='red')
lines(c(0, 250000), c(142000, 142000), col='black', pch=22, lty=2)
lapply(sp_opt_gap, function(gap){
lines(c(gap, gap), c(0, 142000), pch=22, lty=2)
})
legend(140000, 80000, legend=c('alb', 'atr', 'gam'), col=c('green', 'orange', 'red'), lty=1, box.lty = 0, cex=0.8)
800*1000
plot(gap_range, mean_block_length$alb, type = 'l', col='green', xlab = 'Gap size, bp', ylab = 'Mean block length, bp')
lines(gap_range, mean_block_length$atr, col='orange')
lines(gap_range, mean_block_length$gam, col='red')
lines(c(0, 250000), c(142000, 142000), col='black', pch=22, lty=2)
lapply(sp_opt_gap, function(gap){
lines(c(gap, gap), c(0, 142000), pch=22, lty=2)
})
legend(140000, 80000, legend=c('alb', 'atr', 'gam'), col=c('green', 'orange', 'red'), lty=1, box.lty = 0, cex=0.8)
axis(side = 1, labels = seq(0, 250000, 5000))
plot(gap_range, mean_block_length$alb, type = 'l', col='green', xlab = 'Gap size, bp', ylab = 'Mean block length, bp')
lines(gap_range, mean_block_length$atr, col='orange')
lines(gap_range, mean_block_length$gam, col='red')
lines(c(0, 250000), c(142000, 142000), col='black', pch=22, lty=2)
lapply(sp_opt_gap, function(gap){
lines(c(gap, gap), c(0, 142000), pch=22, lty=2)
})
legend(140000, 80000, legend=c('alb', 'atr', 'gam'), col=c('green', 'orange', 'red'), lty=1, box.lty = 0, cex=0.8)
axis(side = 1, at= seq(0, 250000, 5000),  labels = seq(0, 250000, 5000))
plot(gap_range, mean_block_length$alb, type = 'l', col='green', xlab = 'Gap size, bp', ylab = 'Mean block length, bp')
lines(gap_range, mean_block_length$atr, col='orange')
lines(gap_range, mean_block_length$gam, col='red')
lines(c(0, 250000), c(142000, 142000), col='black', pch=22, lty=2)
lapply(sp_opt_gap, function(gap){
lines(c(gap, gap), c(0, 142000), pch=22, lty=2)
})
legend(140000, 80000, legend=c('alb', 'atr', 'gam'), col=c('green', 'orange', 'red'), lty=1, box.lty = 0, cex=0.8)
axis(side = 1, at= seq(0, 250000, 5000),  labels = seq(0, 250000, 5000), padj = 1)
80000+115000+240000
435000/3
source('R/visualize.R')
col_blocks <- unlist(lapply(grimm_g, nrow))
plot(x=gap_range, y=col_blocks, type='l', xlab = 'Gap size bp', ylab='Number of blocks')
source('./R/visualize.R')
source('./R/visualize.R')
source('./R/visualize.R')
source('./R/visualize.R')
blocks <- read.table('./data/processed/blocks.txt')
View(blocks)
