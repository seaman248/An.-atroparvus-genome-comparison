source('./R/f_prepearing_data.R')
source('./R/functions/arrange_chr.R')
source('./R/functions/through.R')
atr_order <- read.csv2('./data/atr_order.csv')
#genes$atr_chr <- arrange_chr(genes[,c(6, 7)], atr_order[,c(1, 2)])
#genes <- na.omit(genes)
genes[, c(6:10)] <- through_num(genes[,c(6:10)], atr_order)
genes[, c(6:10)] <- through_num(genes[,c(6:10)], atr_order)
genes <- na.omit(genes)
source('./R/f_prepearing_data.R')
source('./R/functions/arrange_chr.R')
source('./R/functions/through.R')
atr_order <- read.csv2('./data/atr_order.csv')
#genes$atr_chr <- arrange_chr(genes[,c(6, 7)], atr_order[,c(1, 2)])
#genes <- na.omit(genes)
genes[, c(6:10)] <- through_num(genes[,c(6:10)], atr_order)
genes <- na.omit(genes)
View(genes)
rm(atr_order)
source('./R/f_prepearing_data.R')
source('./R/functions/arrange_chr.R')
source('./R/functions/through.R')
atr_order <- read.csv2('./data/atr_order.csv')
genes$atr_chr <- arrange_chr(genes[,c(6, 7)], atr_order[,c(1, 2)])
genes <- na.omit(genes)
unique(genes$gam_chr)
gam_chrs <- unique(genes$gam_chr)
gam_chrs <- unique(genes$gam_chr)
for(i in 2:length(gam_chrs)){
gam_chrs[i]
}
r for gam and alb
gam_chrs <- unique(genes$gam_chr)
for(i in 2:length(gam_chrs)){
print(gam_chrs[i])
}
View(genes)
gam_chrs <- unique(genes$gam_chr)
for(i in 2:length(gam_chrs)){
print(genes[genes$gam_chr==gam_chrs[i],c(13, 14)])
}
prev_max_coord <- max(genes[genes$gam_chr==gam_chrs[1],14])
gam_chrs <- unique(genes$gam_chr)
prev_max_coord <- max(genes[genes$gam_chr==gam_chrs[1],14])
for(i in 2:length(gam_chrs)){
coords <- genes[genes$gam_chr==gam_chrs[i],c(13, 14)]
coords <- coords + prev_max_coord
prev_max_coord <- prev_max_coord+max(genes[genes$gam_chr==gam_chrs[i], 14])
print(prev_max_coord)
}
source('./R/f_prepearing_data.R')
source('./R/functions/arrange_chr.R')
source('./R/functions/through.R')
atr_order <- read.csv2('./data/atr_order.csv')
genes$atr_chr <- arrange_chr(genes[,c(6, 7)], atr_order[,c(1, 2)])
genes <- na.omit(genes)
genes[, c(6:10)] <- through_num(genes[,c(6:10)], atr_order)
genes <- na.omit(genes)
rm(atr_order)
# make through order for gam and alb
gam_chrs <- unique(genes$gam_chr)
prev_max_coord <- max(genes[genes$gam_chr==gam_chrs[1],14])
for(i in 2:length(gam_chrs)){
genes[genes$gam_chr==gam_chrs[i],c(13, 14)] <-
genes[genes$gam_chr==gam_chrs[i],c(13, 14)] + prev_max_coord
prev_max_coord <- prev_max_coord+max(genes[genes$gam_chr==gam_chrs[i], 14])
}
source('./R/f_prepearing_data.R')
source('./R/functions/arrange_chr.R')
source('./R/functions/through.R')
atr_order <- read.csv2('./data/atr_order.csv')
genes$atr_chr <- arrange_chr(genes[,c(6, 7)], atr_order[,c(1, 2)])
genes <- na.omit(genes)
genes[, c(6:10)] <- through_num(genes[,c(6:10)], atr_order)
genes <- na.omit(genes)
rm(atr_order)
# make through order for gam and alb
gam_chrs <- unique(genes$gam_chr)
prev_max_coord <- max(genes[genes$gam_chr==gam_chrs[1],14])
for(i in 2:length(gam_chrs)){
genes[genes$gam_chr==gam_chrs[i],c(13, 14)] <-
genes[genes$gam_chr==gam_chrs[i],c(13, 14)] + prev_max_coord
prev_max_coord <- prev_max_coord+max(genes[genes$gam_chr==gam_chrs[i], 14])
}
rm(gam_chrs, prev_max_coord)
source('./R/f_prepearing_data.R')
source('./R/functions/arrange_chr.R')
source('./R/functions/through.R')
atr_order <- read.csv2('./data/atr_order.csv')
genes$atr_chr <- arrange_chr(genes[,c(6, 7)], atr_order[,c(1, 2)])
genes <- na.omit(genes)
genes[, c(6:10)] <- through_num(genes[,c(6:10)], atr_order)
genes <- na.omit(genes)
rm(atr_order)
# make through order for gam and alb
gam_chrs <- unique(genes$gam_chr)
prev_max_coord <- max(genes[genes$gam_chr==gam_chrs[1],14])
for(i in 2:length(gam_chrs)){
genes[genes$gam_chr==gam_chrs[i],c(13, 14)] <-
genes[genes$gam_chr==gam_chrs[i],c(13, 14)] + prev_max_coord
prev_max_coord <- prev_max_coord+max(genes[genes$gam_chr==gam_chrs[i], 14])
}
rm(gam_chrs, prev_max_coord, ia)
source('./R/f_prepearing_data.R')
source('./R/functions/arrange_chr.R')
source('./R/functions/through.R')
atr_order <- read.csv2('./data/atr_order.csv')
genes$atr_chr <- arrange_chr(genes[,c(6, 7)], atr_order[,c(1, 2)])
genes <- na.omit(genes)
genes[, c(6:10)] <- through_num(genes[,c(6:10)], atr_order)
genes <- na.omit(genes)
rm(atr_order)
# make through order for gam and alb
gam_chrs <- unique(genes$gam_chr)
prev_max_coord <- max(genes[genes$gam_chr==gam_chrs[1],14])
for(i in 2:length(gam_chrs)){
genes[genes$gam_chr==gam_chrs[i],c(13, 14)] <-
genes[genes$gam_chr==gam_chrs[i],c(13, 14)] + prev_max_coord
prev_max_coord <- prev_max_coord+max(genes[genes$gam_chr==gam_chrs[i], 14])
}
rm(gam_chrs, prev_max_coord, i)
rm(coords)
View(genes)
source('./R/f_prepearing_data.R')
source('./R/functions/arrange_chr.R')
source('./R/functions/through.R')
atr_order <- read.csv2('./data/atr_order.csv')
genes$atr_chr <- arrange_chr(genes[,c(6, 7)], atr_order[,c(1, 2)])
genes <- na.omit(genes)
genes[, c(6:10)] <- through_num(genes[,c(6:10)], atr_order)
genes <- na.omit(genes)
rm(atr_order)
genes[,c(11, 12, 13)]
genes[,c(12, 13, 14)]
through_chr(genes[,c(12, 13, 14)])
through_chr <- function(genes){
chrs <- unique(genes[,1])
prev_max_coord <- max(genes[genes[,1]==chrs[1],3])
for(i in 2:length(chrs)){
genes[genes[,1]==chrs[1],c(3, 4)] <-
genes[genes[,1]==chrs[1],c(3, 4)] + prev_max_coord
prev_max_coord <- prev_max_coord+max(genes[genes[,1]==chrs[i],3])
}
return(genes[,c(2,3)])
}
through_chr(genes[,c(12, 13, 14)])
through_chr <- function(genes){
chrs <- unique(genes[,1])
prev_max_coord <- max(genes[genes[,1]==chrs[1],3])
for(i in 2:length(chrs)){
genes[genes[,1]==chrs[1],c(2, 3)] <-
genes[genes[,1]==chrs[1],c(2, 3)] + prev_max_coord
prev_max_coord <- prev_max_coord+max(genes[genes[,1]==chrs[i],3])
}
return(genes[,c(2,3)])
}
through_chr(genes[,c(12, 13, 14)])
genes[,c(13, 14)] <- through_chr(genes[,c(12, 13, 14)])
source('./R/functions/through_chr.R')
genes[,c(3, 4)] <- through_chr(genes[,c(2, 3, 4)])
source('./R/f_prepearing_data.R')
source('./R/functions/arrange_chr.R')
source('./R/functions/through.R')
source('./R/functions/through_chr.R')
atr_order <- read.csv2('./data/atr_order.csv')
genes$atr_chr <- arrange_chr(genes[,c(6, 7)], atr_order[,c(1, 2)])
genes <- na.omit(genes)
genes[, c(6:10)] <- through_num(genes[,c(6:10)], atr_order)
genes <- na.omit(genes)
rm(atr_order)
# make through order for gam and alb
genes[,c(13, 14)] <- through_chr(genes[,c(12, 13, 14)])
genes[,c(3, 4)] <- through_chr(genes[,c(2, 3, 4)])
View(genes)
source('./R/functions/endToLength.R')
genes$alb_end <- endToLength(genes[,c(3, 4)])
source('./R/f_prepearing_data.R')
source('./R/functions/arrange_chr.R')
source('./R/functions/through.R')
source('./R/functions/through_chr.R')
source('./R/functions/endToLength.R')
atr_order <- read.csv2('./data/atr_order.csv')
genes$atr_chr <- arrange_chr(genes[,c(6, 7)], atr_order[,c(1, 2)])
genes <- na.omit(genes)
genes[, c(6:10)] <- through_num(genes[,c(6:10)], atr_order)
genes <- na.omit(genes)
rm(atr_order)
# make through order for gam and alb
genes[,c(13, 14)] <- through_chr(genes[,c(12, 13, 14)])
genes[,c(3, 4)] <- through_chr(genes[,c(2, 3, 4)])
# end coords to length
genes[,4] <- endToLength(genes[,c(3, 4)])
genes[,9] <- endToLength(genes[,c(8, 9)])
genes[,14] <- endToLength(genes[c(13, 14)])
names(genes[,c(4, 9, 14)]) <- c('alb_length', 'atr_length', 'gam_length')
names(genes[,c(4, 9, 14)])
names(genes[,c(4, 9, 14)]) <- c('alb_length', 'atr_length', 'gam_length')
rename(genes, c('alb_end'='alb_length', 'atr_end'='atr_length', 'gam_end'='gam_length'))
rename(genes, c('alb_end'='alb_length'))
plyr::rename(genes, c('alb_end'='alb_length'))
install.packages("plyr")
source('./R/f_prepearing_data.R')
source('./R/functions/arrange_chr.R')
source('./R/functions/through.R')
source('./R/functions/through_chr.R')
source('./R/functions/endToLength.R')
atr_order <- read.csv2('./data/atr_order.csv')
genes$atr_chr <- arrange_chr(genes[,c(6, 7)], atr_order[,c(1, 2)])
genes <- na.omit(genes)
genes[, c(6:10)] <- through_num(genes[,c(6:10)], atr_order)
genes <- na.omit(genes)
rm(atr_order)
# make through order for gam and alb
genes[,c(13, 14)] <- through_chr(genes[,c(12, 13, 14)])
genes[,c(3, 4)] <- through_chr(genes[,c(2, 3, 4)])
# end coords to length
genes[,4] <- endToLength(genes[,c(3, 4)])
genes[,9] <- endToLength(genes[,c(8, 9)])
genes[,14] <- endToLength(genes[c(13, 14)])
plyr::rename(genes, c('alb_end'='alb_length'))
plyr::rename(genes, alb_end=alb_length))
plyr::rename(genes, alb_end=alb_length)
plyr::rename(genes, 'alb_end'='alb_length')
plyr::rename(genes, c('alb_end'='alb_length'))
genes <- plyr::rename(genes, c('alb_end'='alb_length', 'atr_end'='atr_length', 'gam_end'='gam_length'))
tableForGRIMM <- genes[, c(1, 2, 3, 4, 5, 7, 8, 9, 10, 12, 13, 14, 15)]
View(tableForGRIMM)
write.table(tableForGRIMM,
file='./data/processed/tableForGRIMM.txt',
quote = FALSE,
row.names = FALSE
)
write.table(tableForGRIMM,
file='./data/processed/tableForGRIMM.txt',
quote = FALSE,
row.names = FALSE,
col.names = NA
)
write.table(tableForGRIMM,
file='./data/processed/tableForGRIMM.txt',
quote = FALSE,
row.names = FALSE
)
write.table('./data/processed/blocks.txt')
read.table('./data/processed/blocks.txt')
blocks <- read.table('./data/processed/blocks.txt')
View(blocks)
names(blocks) <- c('id',
'alb_chr', 'alb_start', 'alb_length', 'alb_strand',
'atr_chr', 'atr_start', 'atr_length', 'atr_strand',
'gam_chr', 'gam_start', 'gam_length', 'gam_strand'
)
View(blocks)
blocks[,1]<- as.character(blocks[,1])
View(blocks)
blocks[,c(4, 8, 12)]
blocks[,c(4, 8, 12)] <- blocks[,c(3, 7, 11)]+blocks[,c(4, 8, 12)]
View(blocks)
library('genoPlotR')
install.packages("genoPlotR")
library('genoPlotR')
create_seqs(blocks[,c(1, 3, 4, 5)])
create_seqs <- function(genes){
return(dna_seg(data.frame(
name=genes[,1],
start=genes[,2],
end=genes[,3],
strand=genes[,4]
)))
}
create_seqs(blocks[,c(1, 3, 4, 5)])
create_seqs <- function(genes){
return(dna_seg(data.frame(
name=genes[,1],
start=genes[,2],
end=genes[,3],
strand=genes[,4],
gene_type='blocks'
)))
}
create_seqs(blocks[,c(1, 3, 4, 5)])
alb_seg <- create_seqs(blocks[,c(1, 3, 4, 5)])
source('./R/functions/create_seg.R')
atr_seg <- create_seqs(blocks[,c(1, 7, 8, 9)])
gam_seg <- create_seqs(blocks[,c(1, 11, 12, 13)])
dna_segs <- list(alb_seg, atr_seg, gam_seg)
plot_gene_map(
dna_segs = dna_segs
)
create_xlims <- function(genes, chrs){
xlims <- c()
for(i in 1:length(chrs)){
min_start <- min(genes[genes[,1]==chrs[i], 2])
max_end <- max(genes[genes[,1]==chrs[i], 3])
}
return(xlims)
}
create_xlims(blocks[,2, 3, 4], unique(blocks[,2]))
unique(blocks[,2]
)
create_xlims(blocks[,c(2, 3, 4)], unique(blocks[,2]))
create_xlims <- function(genes, chrs){
xlims <- list()
for(i in 1:length(chrs)){
min_start <- min(genes[genes[,1]==chrs[i], 2])
max_end <- max(genes[genes[,1]==chrs[i], 3])
xlims <- append(c(min_start, max_end))
}
return(unlist(xlims))
}
create_xlims(blocks[,c(2, 3, 4)], unique(blocks[,2]))
create_xlims <- function(genes, chrs){
xlims <- c()
for(i in 1:length(chrs)){
min_start <- min(genes[genes[,1]==chrs[i], 2])
max_end <- max(genes[genes[,1]==chrs[i], 3])
xlims <- append(c(min_start, max_end))
}
return(xlims)
}
create_xlims(blocks[,c(2, 3, 4)], unique(blocks[,2]))
create_xlims <- function(genes, chrs){
xlims <- c()
for(i in 1:length(chrs)){
min_start <- min(genes[genes[,1]==chrs[i], 2])
max_end <- max(genes[genes[,1]==chrs[i], 3])
xlims <- append(xlims, c(min_start, max_end))
}
return(xlims)
}
create_xlims(blocks[,c(2, 3, 4)], unique(blocks[,2]))
create_xlims(blocks[,c(2, 3, 4)], unique(blocks[,2]))
unique(blocks[,2])
source('./R/functions/create_xlims.R')
alb_lims <- create_xlims(blocks[,c(2, 3, 4)], unique(blocks[,2]))
alb_lims <- create_xlims(blocks[,c(2, 3, 4)], unique(blocks[,2]))
atr_lims <- create_xlims(blocks[,c(6, 7, 8)])
atr_lims <- create_xlims(blocks[,c(6, 7, 8)], unique(blocks[,6]))
gam_lims <- create_xlims(blocks[,c(10, 11, 12)], unique(blocks[,10]))
xlims <- list(alb_lims, atr_lims, gam_lims)
plot_gene_map(
dna_segs = dna_segs,
xlims = xlims
)
names(dna_segs) <- c('An. albimanus', 'An. atroparvus', 'An. gambiae')
plot_gene_map(
dna_segs = dna_segs,
xlims = xlims
)
names(blocks) <- c('id',
'alb_chr', 'alb_start', 'alb_end', 'alb_strand',
'atr_chr', 'atr_start', 'atr_end', 'atr_strand',
'gam_chr', 'gam_start', 'gam_end', 'gam_strand'
)
alb_atr_comparison <- comparison(data.frame(
starts1=blocks$alb_start, ends1=blocks$alb_end,
starts2=blocks$atr_start, ends2=blocks$atr_end
))
alb_atr_comparison <- comparison(data.frame(
start1=blocks$alb_start, end1=blocks$alb_end,
start2=blocks$atr_start, end2=blocks$atr_end
))
alb_atr_comparison <- comparison(data.frame(
start1=blocks$alb_start, end1=blocks$alb_end,
start2=blocks$atr_start, end2=blocks$atr_end
))
atr_gam_comparison <- comparison(data.frame(
start1=blocks$atr_start, end1=blocks$atr_end,
start2=blocks$gam_start, end2=blocks$gam_end
))
comparisons <- list(alb_atr_comparison, atr_gam_comparison)
plot_gene_map(
dna_segs = dna_segs,
xlims = xlims,
comparisons = comparisons
)
View(alb_atr_comparison)
source('./R/functions/make_chr_annots.R')
make_chr_annot(alb_lims, unique(blocks[,2]))
source('./R/functions/make_chr_annots.R')
make_chr_annot(alb_lims, unique(blocks[,2]))
source('./R/functions/make_chr_annots.R')
make_chr_annot(alb_lims, unique(blocks[,2]))
source('./R/functions/make_chr_annots.R')
make_chr_annot(alb_lims, unique(blocks[,2]))
alb_annot <- make_chr_annot(alb_lims, unique(blocks[,2]))
alb_annot <- make_chr_annot(alb_lims, unique(blocks[,2]))
atr_annot <- make_chr_annot(atr_lims, unique(blocks[,6]))
gam_annot <- make_chr_annot(gam_lims, unique(blocks[,10]))
annots <- list(alb_annot, atr_annot, gam_annot)
plot_gene_map(
dna_segs = dna_segs,
xlims = xlims,
comparisons = comparisons,
annotations = annots
)
alb_annot
plot_gene_map(
dna_segs = dna_segs,
xlims = xlims,
comparisons = comparisons,
annotations = annots
)
chr_order <- c('2L', '2R', '3L', '3R')
alb_lims <- create_xlims(blocks[,c(2, 3, 4)], chr_order)
atr_lims <- create_xlims(blocks[,c(6, 7, 8)], chr_order)
gam_lims <- create_xlims(blocks[,c(10, 11, 12)], chr_order)
xlims <- list(alb_lims, atr_lims, gam_lims)
alb_annot <- make_chr_annot(alb_lims, chr_order)
atr_annot <- make_chr_annot(atr_lims, chr_order)
gam_annot <- make_chr_annot(gam_lims, chr_order)
annots <- list(alb_annot, atr_annot, gam_annot)
plot_gene_map(
dna_segs = dna_segs,
xlims = xlims,
comparisons = comparisons,
annotations = annots
)
library('genoPlotR')
source('./R/functions/create_seg.R')
source('./R/functions/create_xlims.R')
source('./R/functions/make_chr_annots.R')
blocks <- read.table('./data/processed/blocks.txt')
names(blocks) <- c('id',
'alb_chr', 'alb_start', 'alb_end', 'alb_strand',
'atr_chr', 'atr_start', 'atr_end', 'atr_strand',
'gam_chr', 'gam_start', 'gam_end', 'gam_strand'
)
blocks[,1]<- as.character(blocks[,1])
# length to end coordinates
blocks[,c(4, 8, 12)] <- blocks[,c(3, 7, 11)]+blocks[,c(4, 8, 12)]
# create segs
alb_seg <- create_seqs(blocks[,c(1, 3, 4, 5)])
atr_seg <- create_seqs(blocks[,c(1, 7, 8, 9)])
gam_seg <- create_seqs(blocks[,c(1, 11, 12, 13)])
dna_segs <- list(alb_seg, atr_seg, gam_seg)
names(dna_segs) <- c('An. albimanus', 'An. atroparvus', 'An. gambiae')
# create xlims
chr_order <- c('2L', '2R', '3L', '3R')
alb_lims <- create_xlims(blocks[,c(2, 3, 4)], chr_order)
atr_lims <- create_xlims(blocks[,c(6, 7, 8)], chr_order)
gam_lims <- create_xlims(blocks[,c(10, 11, 12)], chr_order)
xlims <- list(alb_lims, atr_lims, gam_lims)
# create comparisons
alb_atr_comparison <- comparison(data.frame(
start1=blocks$alb_start, end1=blocks$alb_end,
start2=blocks$atr_start, end2=blocks$atr_end
))
atr_gam_comparison <- comparison(data.frame(
start1=blocks$atr_start, end1=blocks$atr_end,
start2=blocks$gam_start, end2=blocks$gam_end
))
comparisons <- list(alb_atr_comparison, atr_gam_comparison)
#create annotations
alb_annot <- make_chr_annot(alb_lims, chr_order)
atr_annot <- make_chr_annot(atr_lims, chr_order)
gam_annot <- make_chr_annot(gam_lims, chr_order)
annots <- list(alb_annot, atr_annot, gam_annot)
plot_gene_map(
dna_segs = dna_segs,
xlims = xlims,
comparisons = comparisons,
annotations = annots
)
alb_lims
library('genoPlotR')
source('./R/functions/create_seg.R')
source('./R/functions/create_xlims.R')
source('./R/functions/make_chr_annots.R')
blocks <- read.table('./data/processed/blocks.txt')
names(blocks) <- c('id',
'alb_chr', 'alb_start', 'alb_end', 'alb_strand',
'atr_chr', 'atr_start', 'atr_end', 'atr_strand',
'gam_chr', 'gam_start', 'gam_end', 'gam_strand'
)
blocks[,1]<- as.character(blocks[,1])
# length to end coordinates
blocks[,c(4, 8, 12)] <- blocks[,c(3, 7, 11)]+blocks[,c(4, 8, 12)]
# create segs
alb_seg <- create_seqs(blocks[,c(1, 3, 4, 5)])
atr_seg <- create_seqs(blocks[,c(1, 7, 8, 9)])
gam_seg <- create_seqs(blocks[,c(1, 11, 12, 13)])
dna_segs <- list(alb_seg, atr_seg, gam_seg)
names(dna_segs) <- c('An. albimanus', 'An. atroparvus', 'An. gambiae')
# create xlims
chr_order <- c('2L', '2R', '3L', '3R')
alb_lims <- create_xlims(blocks[,c(2, 3, 4)], chr_order)
atr_lims <- create_xlims(blocks[,c(6, 7, 8)], chr_order)
gam_lims <- create_xlims(blocks[,c(10, 11, 12)], chr_order)
xlims <- list(alb_lims, atr_lims, gam_lims)
# create comparisons
alb_atr_comparison <- comparison(data.frame(
start1=blocks$alb_start, end1=blocks$alb_end,
start2=blocks$atr_start, end2=blocks$atr_end
))
atr_gam_comparison <- comparison(data.frame(
start1=blocks$atr_start, end1=blocks$atr_end,
start2=blocks$gam_start, end2=blocks$gam_end
))
comparisons <- list(alb_atr_comparison, atr_gam_comparison)
#create annotations
alb_annot <- make_chr_annot(alb_lims, chr_order)
atr_annot <- make_chr_annot(atr_lims, chr_order)
gam_annot <- make_chr_annot(gam_lims, chr_order)
annots <- list(alb_annot, atr_annot, gam_annot)
plot_gene_map(
dna_segs = dna_segs,
xlims = xlims,
comparisons = comparisons,
annotations = annots
)
alb_lims
